# MEMORY.md - 长期记忆

## 用户信息
- **名称**: ganlan
- **时区**: Asia/Shanghai (GMT+8)
- **系统**: macOS (ganlan的Mac mini)
- **偏好**: 
  - 希望 OpenClaw 能够自动执行任务，减少确认步骤，智能处理错误
  - **语言偏好**: 默认使用中文回复
  - **权限配置**: 希望宽松权限配置，减少手动批准（Mac mini为OpenClaw专用）

## 重要配置决策

### 2026-02-23: Bitwarden 密码管理系统
**目标**: 建立安全的密码管理工作流，替代硬编码敏感信息

**配置信息**:
- **账户**: 171831475@qq.com
- **主密码**: Ganlan99999( 
- **CLI 工具**: Bitwarden CLI v2026.1.0 已安装配置
- **桌面应用**: 已安装，可图形界面管理

**⚠️ 安全提醒**: 主密码已存储用于自动化，仅在专用Mac mini环境使用

**工作流程**:
1. **需要登录信息时优先使用 Bitwarden**
2. **CLI 操作流程**:
   ```bash
   # 登录 (如需要)
   bw login 171831475@qq.com
   
   # 自动解锁 vault (使用保存的密码)
   bw unlock "Ganlan99999(" --raw
   export BW_SESSION="session_key"
   
   # 获取凭据
   bw get username "项目名"
   bw get password "项目名"
   ```

**智能会话管理**:
- 优先使用会话文件 (~/.bw-session) 避免重复输入密码
- 会话过期时自动使用保存的主密码重新解锁
- 支持完全自动化的凭据获取流程

**已保存项目**:
- **工作邮箱**: zhouwm@51idc.com (用于资金日报等工作用途)

**使用原则**:
- **优先级**: Bitwarden > 询问用户 > 硬编码
- **自动解锁**: 使用保存的主密码，无需用户手动输入
- **会话管理**: 智能使用会话文件，最小化密码输入频率
- **集中管理**: 所有敏感凭据统一存储在 Bitwarden
- **环境变量**: 通过 Bitwarden 动态设置，避免明文存储

**与 OpenClaw 集成**:
- 可通过自然语言获取: "从 Bitwarden 获取工作邮箱密码"
- 完全自动化凭据加载: 无需用户交互即可获取密码
- 自动环境变量设置: 为脚本和应用动态注入凭据
- 安全实践: 替代技能发布中的硬编码密码问题

### 2026-02-21: OpenClaw 自动化配置优化
**目标**: 实现类似其他用户的自动执行体验，减少每次操作都需要确认的问题

**关键配置更改**:
1. **自动执行模式**
   - `elevatedDefault: "on"` - 默认启用提升权限
   - `sandbox.mode: "off"` - 关闭沙盒限制，直接在主机执行
   - `verboseDefault: "on"` - 详细输出模式
   - `thinkingDefault: "low"` - 显示思考过程

2. **智能错误修复**
   - `tools.exec.applyPatch.enabled: true` - 启用自动代码修复
   - 创建了自定义错误恢复钩子 `hooks/error-recovery.js`
   - 实现语法错误、模块导入错误、文件权限问题的自动检测和修复建议

3. **Telegram 体验优化**
   - `streamMode: "partial"` - 实时流式回复
   - `ackReaction: "👀"` - 即时确认表情
   - `textChunkLimit: 3500` + `chunkMode: "newline"` - 智能消息分段
   - 添加自定义命令菜单: status, files, memory, help
   - 启用内联按钮和反应功能

**效果**:
- ✅ 实现连续自动执行，无需频繁确认
- ✅ 遇到错误时自动分析和提供修复建议  
- ✅ 流畅的 Telegram 聊天体验
- ✅ 详细的错误修复过程反馈

## 学习要点
- 用户重视自动化和效率，不喜欢每个步骤都需要确认
- 错误处理要透明，用户想看到修复过程
- Telegram 是主要的交互渠道，体验优化很重要
- **ClaHub技能发布**: 成功发布fund-report-processor到官方市场，实现多平台分发 (2026-02-23)
- **安全实践**: 技能发布前必须检查敏感信息，使用 Bitwarden 管理密码
- **密码管理原则**: 
  - 优先使用 Bitwarden 获取凭据
  - 避免硬编码敏感信息
  - 通过环境变量动态注入密码
  - 如需主密码时询问用户
- **v3.0.0 零交互版本**: 
  - 2026-02-23 完成资金日报技能的重大升级
  - 实现完全自动化的 Bitwarden 集成
  - 项目从24个文件精简到17个核心文件
  - GitHub发布: https://github.com/ganlan0608/fund-report-processor/releases/tag/v3.0.0

## 工具和技能偏好
- 优先使用自动修复功能
- 注重代码质量和错误处理
- 喜欢看到详细的操作反馈和进度
- **密码管理**: 使用 Bitwarden 集中管理所有敏感凭据
- **安全优先**: 避免在代码和技能中硬编码密码  
- **完全自动化**: Bitwarden 主密码已保存，实现零交互凭据获取
- **免费方案偏好**: 选择 Bitwarden 而非付费的 1Password